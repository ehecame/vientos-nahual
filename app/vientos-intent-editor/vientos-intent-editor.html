<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-input/iron-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/vaadin-date-picker/vaadin-date-picker.html">
<link rel="import" href="../../bower_components/iron-autogrow-textarea/iron-autogrow-textarea.html">
<link rel="import" href="../../bower_components/google-apis/google-maps-api.html">
<link rel="import" href="../../bower_components/vientos-iconset/vientos-iconset.html">

<link rel="import" href="../vientos-styles/vientos-styles.html">
<link rel="import" href="vientos-intent-editor-styles.html">

<dom-module id="vientos-intent-editor">
  <template>

    <style include="vientos-intent-editor-styles"></style>

    <section id="logo">
      <form id="new-image-form">
        <!-- FIXME not showing preview when creating intent, but do when editing  -->
        <div><iron-image src="[[imagePreviewSrc]]" sizing="contain"></iron-image></div>
        <div>
          <input id="new-image"
            type="file"
            accept="image/*"
            on-change="_imageInputChanged">
        </div>
      </form>
    </section>

    <section>
    <paper-input value="{{updated.title}}" label="[[localize('label:title')]]"></paper-input>
      <div>
        <label>[[localize('label:org-description')]]:
          <iron-autogrow-textarea value="{{updated.description}}" ></iron-autogrow-textarea>
        </label>
      </div>

      <div>
        <label>[[localize('label:questions')]]:
          <iron-autogrow-textarea value="{{updated.question}}" ></iron-autogrow-textarea>
        </label>
      </div>
    </section>

    <div id="intent-direction-toggle">
      <iron-icon icon="arrow-forward"></iron-icon>
      <span>[[localize('offer')]]</span>
      <paper-toggle-button on-tap="_toggleDirection" checked="[[toggled]]"></paper-toggle-button>
      <iron-icon icon="arrow-back"></iron-icon>
      <span>[[localize('request')]]</span>
    </div>

    <section>
      <paper-dropdown-menu label="[[localize('label:collaboration-type')]]">
        <paper-listbox
          class="dropdown-content"
          attr-for-selected="name"
          on-iron-select="_setCollaborationType"
          selected="[[updated.collaborationType]]">
          <template is="dom-repeat" items="[[collaborationTypes]]">
            <paper-item name="[[item.id]]">[[localize(item.id)]]</paper-item>
          </template>
        </paper-listbox>
      </paper-dropdown-menu>

      <paper-dropdown-menu label="[[localize('label:collaboration-condition')]]">
        <paper-listbox
          class="dropdown-content"
          attr-for-selected="name"
          on-iron-select="_setCollaborationCondition"
          selected="[[updated.condition]]">
          <template is="dom-repeat" items="[[conditions]]">
            <paper-item name="[[item]]">[[localize(item)]]</paper-item>
          </template>
        </paper-listbox>
      </paper-dropdown-menu>

      <vaadin-date-picker
        id="datepicker"
        value="{{expiryDate}}"
        min="[[expiryMinDate]]"
        label="[[localize('label:expiry-date')]]"></vaadin-date-picker>
    </section>
    
    <section>
      <google-maps-api id="maps" api-key="[[googleMapsApiKey]]" libraries="places" on-api-load="_onGoogleMapsApiLoad"></google-maps-api>
      <label>
        [[localize('label:address')]]
        <div><input id="place-input" value="[[_getMainLocation(project)]]"></div>
      </label>
    </section>


    <paper-button raised
      id="button-save-intent"
      on-tap="_save"
    >[[localize('button:save')]]</paper-button>

    <paper-button raised
      id="button-cancel"
      on-tap="_cancel"
    >[[localize('button:cancel')]]</paper-button>

  </template>

  <script src="vientos-intent-editor.js"></script>

</dom-module>
