<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/vientos-iconset/vientos-iconset.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">

<link rel="import" href="../components/vientos-icon-button/vientos-icon-button.html">

<link rel="import" href="../intent-preview/intent-preview.html">

<link rel="import" href="../vientos-styles/vientos-styles.html">
<link rel="import" href="vientos-project-profile-styles.html">

<dom-module id="vientos-project-profile">
  <template>


    <style include="vientos-project-profile-styles"></style>

    <template is="dom-if" if="[[_canFollow(person, admin)]]">
      <section>
        <template is="dom-if" if="[[!following]]">
          <vientos-icon-button
          raised
          icon="vientos:follow"
          text="[[localize('button:follow')]]"
          on-tap="_follow"
          ></vientos-icon-button>
        </template>
        <template is="dom-if" if="[[following]]">
          <vientos-icon-button
          raised
          icon="vientos:unfollow"
          text="[[localize('button:unfollow')]]"
          on-tap="_unfollow"
          ></vientos-icon-button>
        </template>
      </section>
    </template>
    <template is="dom-if" if="[[admin]]">
      <paper-button raised on-tap="_editDetails">[[localize('button:edit')]]</paper-button>

      <ul id="admin-list">
        <template is="dom-repeat" items="[[_getRef(project.admins, people)]]">
          <li>
            <iron-image src="[[item.logo]]" sizing="contain"></iron-image>
            [[item.name]]
          </li>
        </template>
      </ul>
      <template is="dom-if" if="[[addingNewAdmin]]">
        <div>
          <paper-dropdown-menu label="[[localize('label:select-new-admin')]]">
            <paper-listbox
              class="dropdown-content"
              attr-for-selected="name"
              on-iron-select="_setNewAdmin">
              <template is="dom-repeat" items="[[potentialAdmins]]">
                <paper-item name="[[item._id]]">[[item.name]]</paper-item>
              </template>
            </paper-listbox>
          </paper-dropdown-menu>
          <paper-button raised on-tap="_addNewAdmin" disabled="[[!newAdmin]]">[[localize('button:save')]]</paper-button>
          <paper-button raised on-tap="_cancelAddingAdmin">[[localize('button:cancel')]]</paper-button>
        </div>
      </template>
      <template is="dom-if" if="[[!addingNewAdmin]]">
        <vientos-icon-button
          raised
          on-tap="_startAddingAdmin"
          icon="vientos:add-person"
          text="[[localize('button:add-admin')]]">
        </vientos-icon-button>
      </template>

    </template>


    <header>
      <iron-image src="[[project.logo]]" sizing="contain"></iron-image>
      <div>
        <h2>
          [[project.name]]
        </h2>
      </div>
    </header>

    <section id="project-location">
      <ul>
        <template is="dom-repeat" items="[[project.locations]]" as="location">
          <li>
            <vientos-icon-button
              raised
              on-tap="_showLocationOnMap"
              icon="vientos:crosshairs"
              text="[[location.address]]">
            </vientos-icon-button>
          </li>
        </template>
      </ul>
    </section>

    <section id="project-description">

      [[project.description]]

    </section>
    <section id="project-links">
      <ul>
      <template is="dom-repeat" items="[[project.links]]">
        <li><a href="[[item]]" target="_blank">[[item]]</a></li>
      </template>
      </ul>
    </section>
    <section id="project-contacts">
      <ul>
      <template is="dom-repeat" items="[[project.contacts]]">
        <li>[[item]]</li>
      </template>
      </ul>
    </section>


<template is="dom-if" if="[[admin]]">
  <paper-fab icon="vientos:login" on-tap="_newIntent"></paper-fab>
</template>

<section id="project-collaborations">
  <div>
    <template is="dom-repeat" items="[[requests]]">
      <intent-preview intent="[[item]]"></intent-preview>
    </template>
  </div>
  <div>
    <template is="dom-repeat" items="[[offers]]">
      <intent-preview intent="[[item]]"></intent-preview>
    </template>
  </div>

</section>

  </template>

  <script src="vientos-project-profile.js"></script>

</dom-module>
