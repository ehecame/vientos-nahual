<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">

<link rel="import" href="../../../bower_components/vientos-iconset/vientos-iconset.html">
<link rel="import" href="intent-preview-styles.html">

<dom-module id="intent-preview">
  <template>

    <style include="intent-preview-styles"></style>

    <div class="card" on-tap="_showIntentDetails">
      <div id="main">
        <div id="info">
          <div id="direction">
            <iron-icon icon="vientos:[[intent.direction]]"></iron-icon>
            [[localize(intent.direction)]]
          </div>
          <h2>[[intent.title]]</h2>
        </div>
        <div id="image">
          <template is="dom-if" if="[[intent.logo]]">
            <iron-image src="[[_getThumbnailUrl(intent, 200)]]" sizing="contain"></iron-image>
          </template>
          <template is="dom-if" if="[[!intent.logo]]">
            <iron-icon icon="vientos:[[intent.collaborationType]]"></iron-icon>
          </template>
        </div>
      </div>
      <template is="dom-if" if="[[showProjects]]">
        <div id="projects">
          <ul>
            <template is="dom-repeat" items="[[_getRef(intent.projects, projects)]]" as="project">
              <li>
                <iron-image src="[[_getThumbnailUrl(project, 36)]]" sizing="contain"></iron-image>
                <div>[[project.name]]</div>
              </li>
            </template>
          </ul>
        </div>
      </template>
      <template is="dom-if" if="[[projectAdmin]]">
        <div id="stats">
          <span>
            <iron-icon icon="vientos:conversation"></iron-icon>
            [[intent.openConversations.length]]
            <template is="dom-if" if="[[notificationCount]]">
              <span id="notifications">[[notificationCount]]</span>
            </template>
            <template is="dom-if" if="[[ourTurnCount]]">
              <span id="our-turn">[[ourTurnCount]]</span>
            </template>
          </span>
          <span>
            <iron-icon icon="vientos:success"></iron-icon>
            [[intent.collaborations.length]]
            [[intent.successfulConversations.length]]
          </span>
          <span>
            <iron-icon icon="vientos:aborted"></iron-icon>
          [[intent.abortedConversations.length]]
          </span>
        </div>
      </template>
    </div>
  </template>
  <script src="intent-preview.js"></script>
</dom-module>
