<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/polymer/lib/mixins/gesture-event-listeners.html">
<link rel="import" href="../../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../../bower_components/iron-image/iron-image.html">

<link rel="import" href="../../../bower_components/vientos-iconset/vientos-iconset.html">

<link rel="import" href="../../widgets/vientos-icon-button/vientos-icon-button.html">
<link rel="import" href="../../widgets/conversations-list/conversations-list.html">
<link rel="import" href="../../cards/intent-preview/intent-preview.html">

<link rel="import" href="vientos-inbox-styles.html">

<dom-module id="vientos-inbox">
  <template>

    <style include="vientos-inbox-styles"></style>

    <template is="dom-if" if="[[person]]">

      <section class="action-buttons">
        <vientos-icon-button raised icon="" on-tap="_editProfile" text="[[localize('button:edit-profile')]]"></vientos-icon-button>
        <vientos-icon-button raised icon="" on-tap="_addProject" text="[[localize('button:add-project')]]"></vientos-icon-button>
        <vientos-icon-button raised icon="" on-tap="_bye" text="[[localize('button:logout')]]"></vientos-icon-button>
      </section>
      <h2 id="title">
        [[person.name]]
      </h2>
      <template is="dom-if" if="[[myProjects.length]]">
        <section id="my-projects">
          <ul>
            <template is="dom-repeat" items="[[myProjects]]" as="project">
              <li on-tap="_showProjectProfile" class="clickable">
                <iron-image
                   src="[[_getThumbnailUrl(project, 92)]]"
                   sizing="contain">
                </iron-image>
              </li>
            </template>
          </ul>
        </section>
      </template>

      <section>
        <h3>
          [[localize('label:conversations-list')]]
        </h3>
        <template is="dom-repeat" items="[[activeIntents]]" as="intent">
          <intent-preview intent="[[intent]]" show-projects></intent-preview>
          <div class="conversations">
            <conversations-list
              conversations="[[_filterIntentConversations(intent, myConversations)]]"
              intent="[[intent]]">
            </conversations-list>
          </div>
        </template>
      </section>
    </template>
    <template is="dom-if" if="[[!person]]">
      <ul id="login-buttons">
        <template is="dom-if" if="[[loginProviders.vientos]]">
          <li><a href="[[loginProviders.vientos]]" class="loginBtn loginBtn--vientos">[[localize('button:login-with')]] Vientos</a></li>
        </template>
        <template is="dom-if" if="[[loginProviders.google]]">
          <li><a href="[[loginProviders.google]]" class="loginBtn loginBtn--google">[[localize('button:login-with')]] Google</a></li>
        </template>
        <template is="dom-if" if="[[loginProviders.facebook]]">
          <li><a href="[[loginProviders.facebook]]" class="loginBtn loginBtn--facebook">[[localize('button:login-with')]] Facebook</a></li>
        </template>
      </ul>
    </template>
  </template>

  <script src="vientos-inbox.js"></script>

</dom-module>
