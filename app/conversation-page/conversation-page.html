<link rel="import" href="../../bower_components/polymer/polymer.html">
m
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/vientos-iconset/vientos-iconset.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-autogrow-textarea/iron-autogrow-textarea.html">

<link rel="import" href="../components/vientos-icon-button/vientos-icon-button.html">

<link rel="import" href="../intent-preview/intent-preview.html">

<link rel="import" href="../vientos-styles/vientos-styles.html">
<link rel="import" href="conversation-page-styles.html">

<dom-module id="conversation-page">
  <template>
    <style include="conversation-page-styles"></style>

    <intent-preview intent="[[causingIntent]]" show-projects></intent-preview>
    <template is="dom-if" if="[[matchingIntent]]">
      <intent-preview intent="[[matchingIntent]]" show-projects></intent-preview>
    </template>
    <template is="dom-repeat" items="[[conversation.messages]]" as="message">
      <div>[[message.body]]</div>
    </template>
    <template is="dom-if" if="[[_showNewMessage(conversation, reviewing, editingCollaboration)]]">
      <iron-autogrow-textarea bind-value="{{newMessage}}" ></iron-autogrow-textarea>
      <div><paper-button on-tap="_sendMessage" disabled="[[!newMessage]]">[[localize('button:send')]]</paper-button></div>
    </template>
    <template is="dom-if" if="[[!_showCollaborationEditor(conversation, reviewing, editingCollaboration)]]">
      <template is="dom-if" if="[[_showCollaborationBody(reviewing, success)]]">
        <p>[[conversation.collaboration.body]]</p>
      </template>
      <template is="dom-if" if="[[_showCollaborationEditButton(conversation, reviewing)]]">
        <paper-button on-tap="_toggleCollaborationEditor">[[localize('button:edit-collaboration')]]</paper-button>
      </template>
    </template>
    <template is="dom-if" if="[[_showCollaborationEditor(conversation, reviewing, editingCollaboration)]]">
      <iron-autogrow-textarea bind-value="{{editedCollaboration.body}}"></iron-autogrow-textarea>
      <paper-button on-tap="_saveCollaboration" disabled="[[_disableSaveCollaboration(conversation.collaboration, editedCollaboration.body)]]">[[localize('button:save')]]</paper-button>
      <paper-button on-tap="_cancelCollaborationEditing">[[localize('button:cancel')]]</paper-button>
    </template>
    <template is="dom-repeat" items="[[conversation.reviews]]" as="review">
      <div>[[review.body]]</div>
    </template>
    <template is="dom-if" if="[[_showNewReview(conversation, canReview, reviewing)]]">
      <p>:) :| :(</p>
      <iron-autogrow-textarea bind-value="{{newReview}}" ></iron-autogrow-textarea>
      <paper-button on-tap="_sendReview" disabled="[[!newReview]]">[[localize('button:review')]]</paper-button>
      <paper-button on-tap="_abortReview">[[localize('button:cancel')]]</paper-button>
    </template>
    <template is="dom-if" if="[[_showReviewButton(person, conversation, reviewing, editingCollaboration)]]">
      <div>
        <paper-button on-tap="_abort">[[localize('button:abort')]]</paper-button>
        <template is="dom-if" if="[[conversation.collaboration.body]]">
          <paper-button on-tap="_succeed">[[localize('button:succeed')]]</paper-button>
        </template>
      </div>
    </template>
  </template>

  <script src="conversation-page.js"></script>

</dom-module>
