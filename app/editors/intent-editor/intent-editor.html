<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/polymer/lib/mixins/gesture-event-listeners.html">
<link rel="import" href="../../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../../../bower_components/vaadin-date-picker/vaadin-date-picker.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">

<link rel="import" href="../../../bower_components/vientos-iconset/vientos-iconset.html">
<link rel="import" href="../../widgets/vientos-icon-button/vientos-icon-button.html">
<link rel="import" href="../../widgets/place-picker/place-picker.html">
<link rel="import" href="../../widgets/image-picker/image-picker.html">

<link rel="import" href="intent-editor-styles.html">

<dom-module id="intent-editor">
  <template>

    <style include="intent-editor-styles"></style>

    <section>
      <template is="dom-if" if="[[intentAdmin]]">
        <template is="dom-if" if="[[active]]">
          <vientos-icon-button
            raised
            on-tap="_deactivate"
            disabled="[[!online]]"
            text="[[localize('button:deactivate')]]">
          </vientos-icon-button>
        </template>
        <template is="dom-if" if="[[!active]]">
          <vientos-icon-button
            raised
            on-tap="_activate"
            text="[[localize('button:activate')]]"
            disabled="[[activateButtonDisabled]]"
          ></vientos-icon-button>
        </template>
        <vientos-icon-button
          raised
          text="[[localize('button:leave-admin')]]"
          on-tap="_leaveAdmin"
          disabled="[[!_canLeaveAdmin(intent, intentAdmin, online)]]"
        ></vientos-icon-button>
      </template>
      <template is="dom-if" if="[[!intentAdmin]]">
        <vientos-icon-button
        raised
        text="[[localize('button:become-admin')]]"
        disabled="[[!online]]"
        on-tap="_becomeAdmin"
        ></vientos-icon-button>
      </template>
    </section>

    <section id="intent-direction-toggle">
      <iron-icon icon="vientos:offer"></iron-icon>
      <span>[[localize('offer')]]</span>
      <paper-toggle-button on-tap="_toggleDirection" checked="[[toggled]]"></paper-toggle-button>
      <iron-icon icon="vientos:request"></iron-icon>
      <span>[[localize('request')]]</span>
    </section>

    <section>
    <paper-input
      value="{{updated.title}}"
      label="[[localize('label:title')]]"
      char-counter
      maxlength="60"
      required
    ></paper-input>
      <div>
        <paper-textarea
         rows="3"
         label="[[localize('label:org-description')]]"
         placeholder="[[localize('placeholder:intent-description')]]"
         value="{{updated.description}}"
         required>
       </paper-textarea>
      </div>

      <div>
        <paper-textarea
         rows="3"
         label="[[localize('label:questions')]]"
         placeholder="[[localize('placeholder:intent-question')]]"
         value="{{updated.question}}"
         required>
       </paper-textarea>
      </div>
    </section>

    <section id="logo">
      <image-picker
        image-url="[[updated.logo]]"
        label="[[localize('label:select-image')]]"
        on-picked="_imagePicked"
        ></image-picker>
    </section>

    <section class="select-buttons">
      <h3>[[localize('label:collaboration-type')]]</h3>
      <div>
        <iron-selector selected="{{updated.collaborationType}}" attr-for-selected="name">
          <vientos-icon-button
            name="work"
            text="[[localize('work')]]"
            icon="vientos:work"
            toggles
          ></vientos-icon-button>
          <vientos-icon-button
            name="usage"
            text="[[localize('usage')]]"
            icon="vientos:usage"
            toggles
          ></vientos-icon-button>
          <vientos-icon-button
            name="consumption"
            text="[[localize('consumption')]]"
            icon="vientos:consumption"
            toggles
          ></vientos-icon-button>
          <vientos-icon-button
            name="ownership"
            text="[[localize('ownership')]]"
            icon="vientos:ownership"
            toggles
          ></vientos-icon-button>
        </iron-selector>
      </div>
    </section>

    <section class="select-buttons">
      <h3>[[localize('label:reciprocity')]]</h3>
      <div>
        <vientos-icon-button id="gift" text="[[localize('gift')]]" icon="vientos:gift"></vientos-icon-button>
        <vientos-icon-button text="[[localize('barter')]]" icon="vientos:barter" disabled></vientos-icon-button>
        <vientos-icon-button text="[[localize('time-exchange')]]" icon="vientos:timeexchange" disabled></vientos-icon-button>
        <vientos-icon-button text="[[localize('trade')]]" icon="vientos:trade" disabled></vientos-icon-button>
      </div>
      <div class="support-feature">[[localize('label:support-feature')]]</div>
    </section>

    <section>
      <vaadin-date-picker
        id="datepicker"
        value="{{updated.expiryDate}}"
        min="[[expiryMinDate]]"
        label="[[localize('label:expiry-date')]]"></vaadin-date-picker>
    </section>

    <section>
      <h3>[[localize('label:address')]]</h3>
      <place-picker
        on-picked="_placePicked"
      ></place-picker>
      <ul>
        <template is="dom-repeat" items="[[updated.locations]]" as="placeId">
          <li>
            [[_getPlaceAddress(placeId, places)]]
            <paper-button raised on-tap="_removeLocation">X</paper-button>
          </li>
        </template>
      </ul>
    </section>

    <footer class="simple">

          <paper-button
            id="button-save"
            on-tap="_save"
            disabled="[[!readyToSave]]"
          >[[localize('button:save')]]</paper-button>

          <paper-button
            id="button-cancel"
            on-tap="_cancel"
          >[[localize('button:cancel')]]</paper-button>

    </footer>
  </template>

  <script src="intent-editor.js"></script>

</dom-module>
