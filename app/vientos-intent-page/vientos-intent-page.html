<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/vientos-iconset/vientos-iconset.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">

<link rel="import" href="../components/vientos-icon-button/vientos-icon-button.html">

<link rel="import" href="../vientos-styles/vientos-styles.html">
<link rel="import" href="vientos-intent-page-styles.html">

<dom-module id="vientos-intent-page">
  <template>
    <style include="vientos-intent-page-styles"></style>

    <template is="dom-if" if="[[admin]]">
      <ul>
        <template is="dom-repeat" items="[[conversations]]" as="conversation">
          <li><a href="[[_conversationUrl(conversation)]]">[[_getConversationCreatorName(conversation.creator, people)]]</a></li>
        </template>
      </ul>
    </template>
    <template is="dom-if" if="[[conversationOfCreator]]">
      <p><a href="[[_conversationUrl(conversationOfCreator)]]">[[person.name]]</a></p>
    </template>
    <template is="dom-if" if="[[admin]]">
      <paper-button on-tap="_editIntent">[[localize('button:edit')]]</paper-button>
    </template>

    <h2>[[intent.title]]</h2>
    <p>[[intent.description]]</p>
    <p>[[intent.question]]</p>
    <iron-image src="[[intent.logo]]" sizing="contain"></iron-image>
    <ul>
      <template is="dom-repeat" items="[[intent.locations]]" as="location">
        <li>[[location.address]]</li>
      </template>
    </ul>
    <p>[[localize(intent.collaborationType)]]</p>
    <p>[[localize(intent.condition)]]</p>
    <p>[[intent.direction]]</p>
    <p>[[intent.expiryDate]]</p>

    <ul>
      <template is="dom-repeat" items="[[_getRef(intent.projects, projects)]]" as="project">
        <li><a href="[[_projectPageUrl(project)]]">[[project.name]]</a></li>
      </template>
    </ul>
    <ul>
      <template is="dom-repeat" items="[[_getRef(intent.collaborations, collaborations)]]" as="collaboration">
        <li>
          <div>[[collaboration.body]]</div>
          <template is="dom-repeat" items="[[_reviewsOfCollaboration(collaboration, reviews)]]" as="review">
            <p>[[review.body]]</p>
          </template>
        </li>
      </template>
    </ul>
    <ul>
      <template is="dom-repeat" items="[[_reviewsOfAbortedConversations(intent, reviews)]]" as="reviewsGroup">
        <li>
          <template is="dom-repeat" items="[[reviewsGroup]]" as="review">
            <p>[[review.body]]</p>
          </template>
        </li>
      </template>
    </ul>

    <template is="dom-if" if="[[_collaborateVisible(admin, conversationOfCreator)]]">
      <paper-fab icon="vientos:collaboration" on-tap="_startConversation"></paper-fab>
    </template>
  </template>

  <script src="vientos-intent-page.js"></script>

</dom-module>
